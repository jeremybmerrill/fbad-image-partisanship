(this["webpackJsonpreact-ml-app"]=this["webpackJsonpreact-ml-app"]||[]).push([[0],{50:function(e,a,t){e.exports=t.p+"static/media/image_partisanship.79fad1aa.onnx"},62:function(e,a,t){e.exports=t(83)},7:function(e,a,t){"use strict";(function(e){t.d(a,"c",(function(){return f})),t.d(a,"b",(function(){return h})),t.d(a,"e",(function(){return g})),t.d(a,"d",(function(){return v})),t.d(a,"f",(function(){return w})),t.d(a,"a",(function(){return j}));var n=t(11),r=t.n(n),c=t(49),i=t.n(c),o=t(35),l=t(41),s=t.n(l),u=t(12),m=t.n(u),d=t(50),p=t.n(d),f=256,h=function(e){return e.split("_").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" ")},g=function(){return new o.InferenceSession({backendHint:"webgl"})};function b(e){var a,t,n,c;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:for(t=(a=[1,3,f,f]).reduce((function(e,a){return e*a})),n=new o.Tensor(new Float32Array(t),"float32",a),c=0;c<t;c++)n.data[c]=2*Math.random()-1;return i.next=6,r.a.awrap(e.run([n]));case 6:case"end":return i.stop()}}))}function v(e){return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(e.loadModel(p.a));case 2:return a.next=4,r.a.awrap(b(e));case 4:case"end":return a.stop()}}))}function w(e,a,t){setTimeout((function(){return function(e,a,t){var n,c,i,l,s;return r.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return n=a.width,c=a.height,i=E(a),l=new o.Tensor(i,"float32",[1,3,n,c]),u.next=5,r.a.awrap(e.run([l]));case 5:s=u.sent,t(s);case 7:case"end":return u.stop()}}))}(e,a,t)}),10)}var E=function(e){var a=e.data,t=e.width,n=e.height,r=s()(new Float32Array(a),[t,n,4]),c=s()(new Float32Array(t*n*3),[1,3,t,n]);return m.a.assign(c.pick(0,0,null,null),r.pick(null,null,0)),m.a.assign(c.pick(0,1,null,null),r.pick(null,null,1)),m.a.assign(c.pick(0,2,null,null),r.pick(null,null,2)),m.a.divseq(c,255),m.a.subseq(c.pick(0,0,null,null),.485),m.a.subseq(c.pick(0,1,null,null),.456),m.a.subseq(c.pick(0,2,null,null),.406),m.a.divseq(c.pick(0,0,null,null),.229),m.a.divseq(c.pick(0,1,null,null),.224),m.a.divseq(c.pick(0,2,null,null),.225),c.data},y=function(a){return new Promise((function(t,n){e.setTimeout((function(){return t()}),a)}))},x={maxWidth:f,maxHeight:f,cover:!0,crop:!0,canvas:!0,crossOrigin:"Anonymous",orientation:!0},k=function(e){return new Promise((function(a,t){i()(e,(function(e){return a(e)}),x)}))},j=function(e,a,t){var n,c,i;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(a&&a.current){o.next=2;break}return o.abrupt("return");case 2:return o.next=4,r.a.awrap(k(e));case 4:if("error"!==(n=o.sent).type){o.next=7;break}throw new Error("could not load image");case 7:return(c=a.current.getContext("2d")).drawImage(n,0,0),o.next=11,r.a.awrap(y(1));case 11:i=c.getImageData(0,0,a.current.width,a.current.height),t(i);case 13:case"end":return o.stop()}}))}}).call(this,t(68))},83:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(13),i=t.n(c),o=t(11),l=t.n(o),s=t(19),u=["Dem","GOP","nonpartisan"],m=t(123),d=t(37),p=t(124),f=t(139),h=t(125),g=t(126),b=t(121),v=t(7),w=Object(b.a)({card:{width:v.c,height:v.c},item:{paddingTop:10}});function E(e){var a=e.items,t=w();return r.a.createElement(m.a,{className:t.card},r.a.createElement(p.a,{dense:!0},a.map((function(e){e.avatar;var a=e.name,n=e.percentage,c="".concat(a,"-").concat(n);return r.a.createElement(f.a,{key:c,className:t.item},r.a.createElement(h.a,{id:c,primary:a}),r.a.createElement(g.a,null,r.a.createElement(d.a,null,n,"%")))}))))}function y(e){var a=e.output;if(!a)return null;var t=function(e,a){var t=Array.from(e).map((function(e,a){return[e,a]})).sort((function(e,a){return e[0]<a[0]?-1:e[0]>a[0]?1:0})).reverse().slice(0,a),n=e.map((function(e){return Math.exp(e)})).reduce((function(e,a){return e+a}));return t.map((function(e,a,t){var r=Object(s.a)(e,2),c=r[0],i=r[1];return{breed:u[i],act:c,prob:Math.exp(c)/n}}))}(a,5).map((function(e){var a=e.breed,t=e.prob;return{name:Object(v.b)(a),percentage:(100*t).toFixed(2)}}));return r.a.createElement(E,{items:t})}var x=t(129),k=t(3),j=t(51),O=t.n(j),N=t(128),I=t(135),A=t(127),W=Object(b.a)((function(e){return{box:{width:v.c,padding:0,margin:0},content:{boxSizing:"border-box"},info:{backgroundColor:e.palette.primary.main},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"}}}));function R(e){var a=e.message,t=W();return r.a.createElement(I.a,{className:t.box},r.a.createElement(A.a,{className:Object(k.a)(t.info,t.content),message:r.a.createElement("span",{className:t.message},r.a.createElement(O.a,{className:Object(k.a)(t.icon,t.iconVariant)}),a)}))}function S(e){var a=e.message,t=W();return r.a.createElement(I.a,{className:t.box},r.a.createElement(A.a,{className:t.content,message:r.a.createElement("span",{className:t.message},r.a.createElement(N.a,{size:20,className:t.iconVariant}),a)}))}var T=t(53),C=t.n(T),L=t(52),P=t.n(L),D=Object(b.a)({icon:{width:"50%",height:"50%",color:"grey"}}),F=function(e){var a=e.fileLoaded,t=e.isDragActive,n=D();return a?null:t?r.a.createElement(P.a,{className:n.icon}):r.a.createElement(C.a,{className:n.icon})},q=t(55),z=Object(b.a)({card:{width:v.c,height:v.c,position:"relative",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:10},canvas:{width:v.c,height:v.c,zIndex:0,position:"absolute"},input:{zIndex:9999,position:"absolute"}});function M(e){var a=e.setFile,t=e.canvasRef,c=e.fileLoaded,i=z(),o=Object(n.useCallback)((function(e){if(e.length>1)return console.log("can only handle one file at a time");if(0!==e.length){var t=e[0];if(!t.type.startsWith("image"))return console.log("file must be an image");a(t)}}),[a]),l=Object(q.a)({onDrop:o}),s=l.getRootProps,u=l.getInputProps,d=l.isDragActive;return r.a.createElement(m.a,Object.assign({},s(),{className:i.card}),r.a.createElement("canvas",{className:i.canvas,ref:t,width:v.c,height:v.c}),r.a.createElement("input",Object.assign({alt:"Image Dropzone",type:"image",className:i.input},u())),r.a.createElement(F,{fileLoaded:c,isDragActive:d}))}var B=t(130),G=Object(v.e)(),U=Object(b.a)((function(e){return{root:{flexGrow:1}}}));function H(){var e=Object(n.useState)(!1),a=Object(s.a)(e,2),t=a[0],c=a[1],i=Object(n.useState)(!1),o=Object(s.a)(i,2),u=o[0],m=o[1],d=Object(n.useState)(null),p=Object(s.a)(d,2),f=p[0],h=p[1],g=Object(n.useRef)(null),b=Object(n.useState)(null),w=Object(s.a)(b,2),E=w[0],k=w[1];Object(n.useEffect)((function(){f&&Object(v.a)(f,g,k)}),[f]);var j=Object(n.useState)(null),O=Object(s.a)(j,2),N=O[0],I=O[1];Object(n.useEffect)((function(){t&&E&&Object(v.f)(G,E,I)}),[t,E]);var A=N&&N.values().next().value.data,W=U();return r.a.createElement("div",{className:W.root},r.a.createElement(x.a,{container:!0,spacing:3},r.a.createElement(x.a,{item:!0},r.a.createElement(M,{setFile:h,canvasRef:g,fileLoaded:!!f}),!t&&!u&&r.a.createElement(B.a,{variant:"contained",onClick:function(){return l.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u&&!t){e.next=2;break}return e.abrupt("return");case 2:return m(!0),e.next=5,l.a.awrap(Object(v.d)(G));case 5:c(!0),m(!1);case 7:case"end":return e.stop()}}))}},"Load model (86 MB)"),!t&&u&&r.a.createElement(S,{message:"Loading model..."}),t&&E&&!N&&r.a.createElement(S,{message:"Running model..."}),t&&!f&&r.a.createElement(R,{message:"Add or take a picture..."}),!!f&&!E&&r.a.createElement(S,{message:"Loading image..."})),r.a.createElement(x.a,{item:!0},r.a.createElement(y,{output:A}))))}var V=t(133),J=t(131),_=t(132),$=t(136),K=t(137),Q=t(134),X=t(36),Y=t.n(X),Z=Object(b.a)((function(e){return{root:{flexGrow:1},content:{marginTop:20},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},table:{width:"100%"},footer:{padding:e.spacing(2),marginTop:"auto"},button:{margin:e.spacing(1)}}}));var ee=function(){var e=Z();return r.a.createElement("div",{className:e.root},r.a.createElement(J.a,{position:"static"},r.a.createElement(_.a,null,r.a.createElement(d.a,{variant:"h6",className:e.title},"Political Ad Image Partisanship Classifier"))),r.a.createElement(V.a,{className:e.content},r.a.createElement(d.a,{variant:"body2",className:e.title},"Click Load Model, wait a few seconds for it to load, then drag and drop an image file on the image icon. The model will guess its partisanship!"),r.a.createElement(H,null)),r.a.createElement(V.a,{className:e.content},r.a.createElement($.a,null,r.a.createElement(K.a,{expandIcon:r.a.createElement(Y.a,null),"aria-controls":"panel3a-content",id:"panel3a-header"},r.a.createElement(d.a,{className:e.heading},"What is this good for?")),r.a.createElement(Q.a,null,r.a.createElement(d.a,{variant:"body2"},"Not much. If you submit an image that isn't from a Facebook ad, the prediction will be meaningless. And even for Facebook ad images, this is kind of silly, since partisanship doesn't predict all that much of ad image content."))),r.a.createElement($.a,null,r.a.createElement(K.a,{expandIcon:r.a.createElement(Y.a,null),"aria-controls":"panel3a-content",id:"panel3a-header"},r.a.createElement(d.a,{className:e.heading},"What happens to my data?")),r.a.createElement(Q.a,null,r.a.createElement(d.a,{variant:"body2"},"No image that you take with or add to this application will be uploaded or stored on my or anyone's servers by this application / website. In fact, your images never leave your device, because all the calculations are done in you browser!"))),r.a.createElement($.a,null,r.a.createElement(K.a,{expandIcon:r.a.createElement(Y.a,null),"aria-controls":"panel3a-content",id:"panel3a-header"},r.a.createElement(d.a,{className:e.heading},"credits")),r.a.createElement(Q.a,null,r.a.createElement(V.a,null,r.a.createElement(d.a,{variant:"body2"},"I borrowed this app and much of the code from ",r.a.createElement("a",{href:"https://github.com/davidpfahler"},"David Pfahler"),". The Image partisanship bit is all me though. If you want to learn more about the app code, check out the ",r.a.createElement("a",{href:"https://github.com/davidpfahler/react-ml-app"},"GitHub repository"),".")))),r.a.createElement("footer",{className:e.footer})))},ae=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function te(e,a){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),a&&a.onUpdate&&a.onUpdate(e)):(console.log("Content is cached for offline use."),a&&a.onSuccess&&a.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(r.a.createElement(ee,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/fbad-image-partisanship",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var a="".concat("/fbad-image-partisanship","/service-worker.js");ae?(!function(e,a){fetch(e).then((function(t){var n=t.headers.get("content-type");404===t.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):te(e,a)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(a,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):te(a,e)}))}}()}},[[62,1,2]]]);
//# sourceMappingURL=main.67986805.chunk.js.map